# Sprint14
## Актуальная версия V1.0
#### Цель данной работы: продолжение знакоства с Node.js и библиотекой express. А точнее с аутентификацией и авторизоцией пользователей, а ещё познакомились с основными принципами безопасности веб-приложений. Эта работа является продолжением [спринта 13](https://github.com/muratbyazrov/Yandex_sprint13), которая как мы помним явлется бэк частью проекта [Место](https://github.com/muratbyazrov/Mesto_from_yandex_praktikum)
#### Что добавлено?
- в схеме пользователя появились обязательные `email` и `password`;
- поле `email` уникально и валидируется с помощью подключённого валидатора
- в контроллере createUser почта и хеш пароля записываются в базу;
- появился контроллер login, он проверяет, полученные в теле запроса почту и пароль;
- если почта и пароль верные, контроллер `login` создаёт `JWT`, в пейлоуд которого записано свойство `_id` с идентификатором пользователя; срок жизни токена — 7 дней;
- если почта и пароль верные, контроллер `login` записывает токен в куки браузера;
- если почта и пароль не верные, контроллер `login` возвращает ошибку 401;
- в роутах пользователей появились обработчики `POST`-запросов на роуты `/signin` и `/signup`;
- добавлен файл `middlewares/auth.js`, в нём мидлвэр для проверки `JWT`;
  - при правильном `JWT` авторизационный мидлвэр добавляет в объект запроса пейлоуд и пропускает запрос дальше;
  - при неправильном `JWT` авторизационный мидвэр возвращает ошибку 401;
- все роуты, кроме `/signin` и `/signup`, защищены авторизацией;
- удалён хардкод `req.user` из самостоятельного проекта предыдущего спринта;
- API не возвращает хеш пароля;

#### Чтобы развернуть проект, нужно склонировать себе проект и запустить один из скриптов `start` или `dev`. Сборка start `npm run start` запустит проект на логакльном сервере `localhost:3000`. Скрипт run `npm run dev` апустит проект на логакльном сервере `localhost:3000` с возможностью хот релоуд.
